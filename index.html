<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search Engine with Kids Mode</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        .search-results {
            margin-top: 20px;
        }
        .result-item {
            margin-bottom: 10px;
        }
        .toggle-container {
            margin-bottom: 20px;
        }
    </style>
</head>
<body>

    <h1>Search Engine</h1>
    
    <div class="toggle-container">
        <label>
            <input type="checkbox" id="kidsModeToggle" />
            Enable Kids Mode
        </label>
    </div>

    <input type="text" id="searchInput" placeholder="Search..." />
    
    <div id="searchResults" class="search-results"></div>

    <script src="https://cdn.jsdelivr.net/npm/lunr@2.3.8/lunr.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const kidsModeToggle = document.getElementById('kidsModeToggle');
            const searchInput = document.getElementById('searchInput');
            const searchResults = document.getElementById('searchResults');

            let currentData = [];
            let index;

            // Function to load JSON data
            async function loadData(kidsMode) {
                const file = kidsMode ? 'nonkidfriendlysearch.json' : 'search.json';
                const response = await fetch(file);
                currentData = await response.json();
                index = lunr(function() {
                    this.ref('url');
                    this.field('title');
                    this.field('content');
                    currentData.forEach(doc => this.add(doc));
                });
            }

            // Load initial data (default: Kids Mode off)
            loadData(false);

            // Handle Kids Mode toggle
            kidsModeToggle.addEventListener('change', function() {
                loadData(kidsModeToggle.checked);
                searchInput.value = ''; // Clear the search input
                searchResults.innerHTML = ''; // Clear the results
            });

            // Handle search input
            searchInput.addEventListener('input', function() {
                const query = searchInput.value.trim();
                if (query.length > 0) {
                    const results = index.search(query);
                    searchResults.innerHTML = results.length > 0
                        ? results.map(result => {
                            const doc = currentData.find(d => d.url === result.ref);
                            return `<div class="result-item"><a href="${doc.url}"><strong>${doc.title}</strong></a><p>${doc.content}</p></div>`;
                        }).join('')
                        : '<p>No results found</p>';
                } else {
                    searchResults.innerHTML = '';
                }
            });
        });
    </script>

</body>
</html>
